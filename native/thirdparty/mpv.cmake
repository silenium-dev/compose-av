add_library(mpv STATIC IMPORTED)
if (NOT DEFINED MPV_A_LOCATION)
    set(MPV_URL "https://reposilite.silenium.dev/releases/dev/silenium/libs/mpv/mpv-natives-${MPV_PLATFORM}${MPV_PLATFORM_EXTENSION}/${MPV_VERSION}/mpv-natives-${MPV_PLATFORM}${MPV_PLATFORM_EXTENSION}-${MPV_VERSION}.zip")
    set(MPV_URL_SHA256 "https://reposilite.silenium.dev/releases/dev/silenium/libs/mpv/mpv-natives-${MPV_PLATFORM}${MPV_PLATFORM_EXTENSION}/${MPV_VERSION}/mpv-natives-${MPV_PLATFORM}${MPV_PLATFORM_EXTENSION}-${MPV_VERSION}.zip.sha256")
    set(MPV_PREFIX "${CMAKE_BINARY_DIR}/mpv")
    message(STATUS "Downloading mpv from ${MPV_URL}")

    file(DOWNLOAD "${MPV_URL_SHA256}" "${CMAKE_BINARY_DIR}/mpv.zip.sha256")
    file(READ "${CMAKE_BINARY_DIR}/mpv.zip.sha256" MPV_SHA256)
    file(DOWNLOAD "${MPV_URL}" "${CMAKE_BINARY_DIR}/mpv.zip" EXPECTED_HASH SHA256=${MPV_SHA256} SHOW_PROGRESS)
    file(ARCHIVE_EXTRACT INPUT "${CMAKE_BINARY_DIR}/mpv.zip" DESTINATION "${MPV_PREFIX}")

    set(MPV_INCLUDE_DIR "${MPV_PREFIX}/include")
    set(MPV_LIB_DIR "${MPV_PREFIX}/lib")
    set_target_properties(mpv PROPERTIES IMPORTED_LOCATION "${CMAKE_CURRENT_BINARY_DIR}/libmpv.a")
    target_include_directories(mpv INTERFACE "${MPV_INCLUDE_DIR}")
else ()
    set_target_properties(mpv PROPERTIES IMPORTED_LOCATION "${MPV_A_LOCATION}")
endif ()

target_link_options(mpv INTERFACE "-Wl,-Bsymbolic")
